

# Overview
 This patch addresses the vulnerability described in CVE-2022-0001, a  Branch History Injection Issue in Microsoft systems via intune.
 
The files can be found at https://github.com/anguzz/powershell/tree/main/intune/patch-CVE-2022-0001.

https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-0001

https://www.reddit.com/r/crowdstrike/comments/1di667b/spotlight_cve20220001_false_positive/

https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/advisory-guidance/branch-history-injection.html 


# Correction Note
Microsoft's initial guidance provided an incorrect hex value for mitigating this vulnerability. The original recommended value was 0x00800000 (decimal: 8388608). However, the correct value to fully mitigate this and other speculative vulnerabilities is 0x00800045 (decimal: 8388680).


# Installation Instructions
- Download the `patch-CVE-2022-0001` folder from the repository.

- Use the `IntuneWinAppUtil` tool to package the `install.ps1` file. Ensure to point it to the directory that contains the script and any dependent files. This process will convert the directory contents into an .intunewin file, which is required for deployment through Intune

- Install command `powershell -ex bypass -file install.ps1`

- Uninstall command  `powershell -ex bypass -file uninstall.ps1`. This will restore the original registry settings prior to the patch application.


- Detecion rule to look at registry key path of  `Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management`
for an exisitng value of FeatureSettingsOverride. 


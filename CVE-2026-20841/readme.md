# CVE-2026-20841 – Windows Notepad Remote Code Execution

## Overview

**CVE ID:** CVE-2026-20841
**Severity:** High (CVSS 8.8)
**Vendor:** Microsoft
**Product:** Windows Notepad

A Remote Code Execution (RCE) vulnerability in Windows Notepad allows malicious Markdown (`.md`) files to invoke external protocol handlers. When triggered, an external process may execute in the context of the logged-in user.

This vulnerability was disclosed on **February 10, 2026**.

---

## Background / Vulnerability Description

### Summary

Opening a crafted Markdown file may:

1. Trigger a protocol handler
2. Launch an external application or process
3. Execute code as the current user

### Attack Scenario

| Step | Description                              |
| ---- | ---------------------------------------- |
| 1    | User opens malicious `.md` file          |
| 2    | Embedded link invokes custom URI handler |
| 3    | External app launches                    |
| 4    | Code executes as logged-in user          |

### Risk

* **Impact:** User-level code execution
* **Potential:** Payload staging, lateral movement
* **Attack Surface:** Any endpoint running vulnerable Store-based Notepad
* **CVSS:** 8.8 (High)

### Affected Versions

```
Microsoft.WindowsNotepad < 11.2510
```

Store-based version only (Windows 11 AppX package).

---

## Correction Notes / Special Considerations

* Notepad is delivered via Microsoft Store (AppX).
* Standard Windows Update does **not** always guarantee immediate update.
* Some devices auto-update; others require forced remediation.
* Winget may not exist on all systems.
* Script is idempotent and safe to re-run.

---

## Remediation

### Step 1 – Tanium Discovery

**Sensor / Question**

```
Get Installed Store Apps from all entities
Filter:
Name contains Microsoft.WindowsNotepad
Version < 11.2510
```

Identify all non-compliant endpoints.

---

### Step 2 – Package Deployment (Tanium)

**Package Name:**
`CVE-2026-20841 – Notepad Update`

**Install Command**

```
cmd.exe /c powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NonInteractive -NoProfile -File patch.ps1
```

---

### Remediation Script (patch.ps1)


---

### Verification Query

```sql
( Installed Store Apps:Name contains Microsoft.WindowsNotepad
  and Installed Store Apps:Version >= 11.2510 )
```

---

## Step 3 – Hardening (Defense-in-Depth)

### Policy: Disable Web-to-App Linking (App URI Handlers)

**CSP Path:**
ApplicationDefaults → EnableAppUriHandlers

**Configuration:**

```
Enable App Uri Handlers = Disabled
```

### Security Impact

* Prevents `http(s)` URIs from launching local applications
* Forces links to open in default browser
* Reduces protocol handler abuse surface

### Rollout Plan

1. Test devices
2. Small pilot ring
3. Broad production deployment

---

## Deployment Plan

| Phase   | Action                                                 |
| ------- | ------------------------------------------------------ |
| Phase 1 | Immediate Tanium deployment to non-compliant endpoints |
| Phase 2 | Validate compliance via Tanium question                |
| Phase 3 | Deploy hardening configuration policy                  |
| Phase 4 | Confirm 99%+ compliance                                |

**Target Timeline:** 24–48 hours

---

## Expected Results

* Silent background update
* No user interruption
* RCE vector mitigated
* Reduced protocol handler abuse risk

---

## Research Notes

Failure to remediate could allow:

* Phishing-based exploitation
* Payload execution from email attachments
* User-context privilege abuse
* Internal lateral staging

Given widespread Markdown usage, risk exposure is elevated in enterprise environments.

---

## Outcome

* Notepad updated to **11.2510+** across environment
* Non-compliant endpoints targeted via Tanium remediation package
* Web-to-App Linking disabled as additional control
* Attack surface reduced and CVE exposure closed

---

## References

* Microsoft Security Response Center – CVE-2026-20841
  [https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841)

* CVE Record – CVE-2026-20841
  [https://www.cve.org/CVERecord?id=CVE-2026-20841](https://www.cve.org/CVERecord?id=CVE-2026-20841)

* Microsoft Learn – ApplicationDefaults CSP
  [https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-ApplicationDefaults?WT.mc_id=Portal-fx#enableappurihandlers](https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-ApplicationDefaults?WT.mc_id=Portal-fx#enableappurihandlers)

* Neowin – Microsoft patches Notepad flaw
  [https://www.neowin.net/news/microsoft-patches-notepad-flaw-that-could-let-attackers-hijack-windows-pcs/](https://www.neowin.net/news/microsoft-patches-notepad-flaw-that-could-let-attackers-hijack-windows-pcs/)

* Reddit – r/sysadmin community discussion   [https://www.reddit.com/r/sysadmin/comments/1r1vaon/windows_notepad_app_remote_code_execution/](https://www.reddit.com/r/sysadmin/comments/1r1vaon/windows_notepad_app_remote_code_execution/)
